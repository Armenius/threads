<!doctype html>
<html>
<head>
    <title>Socket.IO chat</title>
    <script
            src="https://code.jquery.com/jquery-3.1.1.min.js"
            integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
            crossorigin="anonymous"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="chat.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <script id="server" type="application/javascript" data-src="123asd" src="index.js"></script>

</head>
<body>

<ul class="chat-thread" id="messages" style="height: 85vh; overflow-y: auto;">
    <div id="videos">
        <video id="localVideo" autoplay muted></video>
        <video id="remoteVideo" autoplay></video>
    </div>

    <span id="hangup" class="glyphicon glyphicon-remove-circle"></span>
    <!--<button value="startCall" id="startCall" onclick="startCall(0)"> Start Call </button>-->
    <!--<button value="hangup" id="hangup" onclick="hangup()" style="display: none"> Hangup</button>-->
</ul>

<div class="group" style="position: fixed;
    left: 0;
    bottom: 0; height: 5vh; background: transparent; width: 90%">
    <form action="">
        <input id="m" type="text" class="enter-msg-box" autocomplete="off" required>
        <span class="highlight"></span>
        <span class="bar"></span>
        <label>Enter message</label>
        <i class="glyphicon glyphicon-earphone call" value="startCall" id="startCall"></i>
    </form>
</div>

<script type="text/javascript" src="chat.js"> </script>
<script type="text/javascript">
    var myLink = document.getElementById('startCall');

    myLink.onclick = function(){
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "videochat.js";
        document.getElementsByTagName("head")[0].appendChild(script);
        var hangup = document.getElementById('hangup');
        hangup.onclick = function () {
            console.log('Hanging up.');
            stop();
            sendMessage('bye');
            document.getElementById('startCall').style.display = 'block';
            document.getElementById('localVideo').style.display = 'none';
            document.getElementById('remoteVideo').style.display = 'none';
            document.getElementById('hangup').style.display = 'none';
            document.getElementById('videos').style.display = 'none';
            localStream.getTracks().forEach(function(track) {
                track.stop();
            });
            // remoteStream.getTracks().forEach(function(track) {
            //     track.stop();
            // });
            // localStream.stop();
        };
        return false;
    };
</script>



</body>
</html>